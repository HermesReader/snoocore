{"version":3,"sources":["src/Throttle-test.js"],"names":[],"mappings":"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","file":"src/Throttle-test.js","sourcesContent":["/* describe, it, afterEach, beforeEach */\nrequire(\"babel/register\");\n\nvar chai = require('chai');\nvar chaiAsPromised = require('chai-as-promised');\nchai.use(chaiAsPromised);\nvar expect = chai.expect;\n\nvar when = require('when');\nvar delay = require('when/delay');\n\nvar config = require('../config');\n\nvar Throttle = require('../../src/Throttle');\n\ndescribe('Throttle.', function () {\n\n  this.timeout(config.testTimeout);\n\n  describe('wait()', function() {\n\n    it('properly wait before calling anything', function() {\n      var throttle = new Throttle();\n      expect(throttle._throttleDelay).to.equal(1);\n\n      var one = throttle.wait();\n      expect(throttle._throttleDelay).to.equal(1001);\n\n      var two = throttle.wait();\n      expect(throttle._throttleDelay).to.equal(2001);\n\n      var three = throttle.wait();\n      expect(throttle._throttleDelay).to.equal(3001);\n\n      // - - -\n\n      var order = [];\n\n      var afterOne = one.then(function() {\n        order.push({ id: 1, now: Date.now() });\n      });\n\n      var afterTwo = two.then(function() {\n        order.push({ id: 2, now: Date.now() });\n      });\n\n      var afterThree = three.then(function() {\n        order.push({ id: 3, now: Date.now() });\n      });\n\n      return when.all([ afterOne, afterTwo, afterThree ]).then(function() {\n\n        // check order\n        expect(order[0].id).to.equal(1);\n        expect(order[1].id).to.equal(2);\n        expect(order[2].id).to.equal(3);\n\n        // check that we actually waited for the throttleMs time between each\n        // it won't be exactly 1000 as there may be other things in the\n        // event loop that slow things down for us.\n        expect(order[1].now - order[0].now).to.be.gt(900);\n        expect(order[2].now - order[1].now).to.be.gt(900);\n\n        // check that throttleDelay been reset to 1ms\n        expect(throttle._throttleDelay).to.equal(1);\n\n        // check that a new wait() should be almost instant\n        var preWaitNow = Date.now();\n        return throttle.wait().then(function() {\n          expect(Date.now() - preWaitNow < 50).to.equal(true);\n        });\n      });\n\n    });\n\n  });\n\n\n});\n"],"sourceRoot":"/source/"}