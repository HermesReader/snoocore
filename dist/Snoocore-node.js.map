{"version":3,"sources":["Endpoint.js","OAuth.js","RedditRequest.js","Request.js","Snoocore.js","Throttle.js","UserConfig.js","utils.js","https/file.js","https/form.js","https/httpsBrowser.js","https/httpsNode.js"],"names":[],"mappings":"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","file":"Snoocore-node.js","sourcesContent":["import path from 'path';\n\nimport utils from './utils';\n\n// Precompiled list of properties for specific endpoints\nimport endpointProperties from '../build/endpointProperties';\n\n// Build a more parseable tree for the properties. Built here vs. simply\n// requiring an already build tree to save on bytes.\nvar PROPERTY_TREE = buildPropertyTree(endpointProperties);\n\nmodule.exports = Endpoint;\nfunction Endpoint(userConfig, method, endpointPath, givenArgs, contextOptions) {\n  var self = this;\n\n  self.method = method;\n  self.path = endpointPath;\n\n  self.properties = getProperties();\n\n  // if this endpoint requires the `api_type` string of \"json\"\n  // in it's request\n  self.needsApiTypeJson = self.properties.indexOf('a') !== -1;\n\n  self.contextOptions = normalizeContextOptions();\n  self.args = buildArgs();\n  self.url = buildUrl();\n\n  function getProperties() {\n    // remove leading slash if any\n    var sections = self.path.replace(/^\\//, '').split('/');\n\n    // the top level of the endpoint tree that we will traverse down\n    var leaf = PROPERTY_TREE;\n\n    var section;\n\n    for (var i = 0, len = sections.length; i < len; ++i) {\n      section = sections[i];\n\n      // We can go down further in the tree\n      if (typeof leaf[section] !== 'undefined') {\n        leaf = leaf[section];\n        continue;\n      }\n\n      // Check if there is a placeholder we can go down\n      if (typeof leaf['$'] !== 'undefined') {\n        leaf = leaf['$'];\n        continue;\n      }\n\n      break; // else, dead end\n    }\n\n    if (leaf._endpoints && leaf._endpoints[self.method]) {\n      return leaf._endpoints[self.method];\n    }\n\n    return '';\n  }\n\n  /*\n     Returns a set of options that effect how each call to reddit behaves.\n   */\n  function normalizeContextOptions() {\n\n    var cOptions = contextOptions || {};\n\n    // by default we do not bypass authentication\n    cOptions.bypassAuth = utils.thisOrThat(cOptions.bypassAuth, false);\n\n    // decode html enntities for this call?\n    cOptions.decodeHtmlEntities = utils.thisOrThat(cOptions.decodeHtmlEntities,\n                                                   userConfig.decodeHtmlEntities);\n\n    // how many attempts left do we have to retry an endpoint?\n\n    // use the given retryAttemptsLeft, or the retryAttempts passed in the\n    // context options if not specified\n    cOptions.retryAttemptsLeft = utils.thisOrThat(cOptions.retryAttemptsLeft,\n                                                  cOptions.retryAttempts);\n\n    // use the given retryAttemptsLeft, or the retryAttempts passed in the\n    // user configuration\n    cOptions.retryAttemptsLeft = utils.thisOrThat(cOptions.retryAttemptsLeft,\n                                                  userConfig.retryAttempts);\n\n    // delay between retrying an endpoint\n    cOptions.retryDelay = utils.thisOrThat(cOptions.retryDelay,\n                                           userConfig.retryDelay);\n\n    // how many reauthentication attempts do we have left?\n    cOptions.reauthAttemptsLeft = utils.thisOrThat(cOptions.reauthAttemptsLeft,\n                                                   cOptions.retryAttemptsLeft);\n\n    return cOptions;\n  }\n\n  /*\n     Build the arguments that we will send to reddit in our\n     request. These customize the request that we send to reddit\n   */\n  function buildArgs() {\n\n    givenArgs = givenArgs || {};\n    var args = {};\n\n    // Skip any url parameters (e.g. items that begin with $)\n    for (var key in givenArgs) {\n      if (key.substring(0, 1) !== '$') {\n        args[key] = givenArgs[key];\n      }\n    }\n\n    var apiType = utils.thisOrThat(self.contextOptions.api_type,\n                                   userConfig.apiType);\n\n    if (apiType && self.needsApiTypeJson) {\n      args.api_type = apiType;\n    }\n\n    return args;\n  }\n\n  /*\n     Builds the URL that we will query reddit with.\n   */\n  function buildUrl() {\n    var serverOAuth = utils.thisOrThat(self.contextOptions.serverOAuth,\n                                       userConfig.serverOAuth);\n\n    var url = 'https://' + path.join(serverOAuth, self.path);\n    url = replaceUrlParams(url, givenArgs);\n    return url;\n  }\n\n\n}\n\n\n/*\n   Converts a list of endpoint properties into a tree for\n   faster traversal during runtime.\n */\nmodule.exports.buildPropertyTree = buildPropertyTree;\nfunction buildPropertyTree(endpointProperties) {\n  var propertyTree = {};\n\n  Object.keys(endpointProperties).forEach(function(endpointPath) {\n\n    // get the properties for this endpoint\n    var properties = endpointProperties[endpointPath];\n\n    // get the sections to traverse down for this endpoint\n    var pathSections = endpointPath.split('/');\n\n    // the first element in this list is the endpoint method\n    var method = pathSections.shift().toLowerCase();\n\n    var leaf = propertyTree; // start at the root\n\n    // move down to where we need to be in the chain for this endpoint\n    var i = 0;\n    var len = pathSections.length;\n\n    for (; i < len - 1; ++i) {\n      if (typeof leaf[pathSections[i]] === 'undefined') {\n        leaf[pathSections[i]] = {};\n      }\n      leaf = leaf[pathSections[i]];\n    }\n\n    // push the endpoint to this section of the tree\n    if (typeof leaf[pathSections[i]] === 'undefined') {\n      leaf[pathSections[i]] = { _endpoints: {} };\n    }\n\n\n    leaf[pathSections[i]]._endpoints[method] = properties;\n  });\n\n  return propertyTree;\n}\n\n\n/*\n   Takes an url, and an object of url parameters and replaces\n   them, e.g.\n\n   endpointUrl:\n   'http://example.com/$foo/$bar/test.html'\n\n   givenArgs: { $foo: 'hello', $bar: 'world' }\n\n   would output:\n\n   'http://example.com/hello/world/test.html'\n */\n\nmodule.exports.replaceUrlParams = replaceUrlParams;\nfunction replaceUrlParams(endpointUrl, givenArgs) {\n  // nothing to replace!\n  if (endpointUrl.indexOf('$') === -1) {\n    return endpointUrl;\n  }\n\n  // pull out variables from the url\n  var params = endpointUrl.match(/\\$[\\w\\.]+/g);\n\n  // replace with the argument provided\n  params.forEach(function(param) {\n    if (typeof givenArgs[param] === 'undefined') {\n      throw new Error('missing required url parameter ' + param);\n    }\n    endpointUrl = endpointUrl.replace(param, givenArgs[param]);\n  });\n\n  return endpointUrl;\n}\n","import querystring from 'querystring';\nimport util from 'util';\nimport urlLib from 'url';\n\nimport when from 'when';\n\nimport utils from './utils';\n\nmodule.exports = OAuth;\n\n/*\n   Various OAuth types\n */\nvar TOKEN = module.exports.TOKEN = {\n  EXPLICIT: 'explicit',\n  IMPLICIT: 'implicit',\n  SCRIPT: 'script',\n  APP_ONLY: 'app_only',\n  REFRESH: 'refresh'\n};\n\n/*\n   Represents an unset/invalid token\n */\nvar INVALID_TOKEN = module.exports.INVALID_TOKEN = 'invalid_token';\n\n/*\n   Represents a single OAuth instance. Used primarily for internal\n   use within the Snoocore class to manage two OAuth instances -\n   Applicaton Only and an Authenticated Session.\n\n */\nfunction OAuth(userConfig, request) {\n  var self = this;\n\n  self._userConfig = userConfig;\n\n  self._request = request;\n\n  self.accessToken = INVALID_TOKEN;\n  self.refreshToken = INVALID_TOKEN;\n  self.tokenType = 'bearer';\n\n  self.scope = normalizeScope();\n\n  /*\n     Takes a given scope, and normalizes it to a proper string.\n   */\n  function normalizeScope() {\n    var scope;\n    // Set to empty string if the scope if not set\n    if (typeof self._userConfig.oauth.scope === 'undefined') {\n      scope = '';\n    }\n    // convert an array into a string\n    else if (util.isArray(self._userConfig.oauth.scope)) {\n      scope = self._userConfig.oauth.scope.join(',');\n    }\n    return scope;\n  }\n\n  /*\n     Do we have a refresh token defined?\n   */\n  self.hasRefreshToken = function() {\n    return self.refreshToken !== INVALID_TOKEN;\n  };\n\n  /*\n     Are we currently authenticated?\n   */\n  self.isAuthenticated = function() {\n    return self.accessToken !== INVALID_TOKEN;\n  };\n\n  self.getAuthorizationHeader = function() {\n    return self.tokenType + ' ' + self.accessToken;\n  };\n\n  /*\n     Get the Explicit Auth Url.\n   */\n  self.getExplicitAuthUrl = function(state) {\n\n    var query = {};\n\n    query.client_id = self._userConfig.oauth.key;\n    query.state = state || Math.ceil(Math.random() * 1000);\n    query.redirect_uri = self._userConfig.oauth.redirectUri;\n    query.duration = self._userConfig.oauth.duration || 'temporary';\n    query.response_type = 'code';\n    query.scope = self.scope;\n\n    var baseUrl = 'https://' + self._userConfig.serverWWW + '/api/v1/authorize';\n\n    if (self._userConfig.mobile) {\n      baseUrl += '.compact';\n    }\n\n    return baseUrl + '?' + querystring.stringify(query);\n  };\n\n  /*\n     Get the Implicit Auth Url.\n   */\n  self.getImplicitAuthUrl = function(state) {\n\n    var query = {};\n\n    query.client_id = self._userConfig.oauth.key;\n    query.state = state || Math.ceil(Math.random() * 1000);\n    query.redirect_uri = self._userConfig.oauth.redirectUri;\n    query.response_type = 'token';\n    query.scope = self.scope;\n\n    var baseUrl = 'https://' + self._userConfig.serverWWW + '/api/v1/authorize';\n\n    if (self._userConfig.mobile) {\n      baseUrl += '.compact';\n    }\n\n    return baseUrl + '?' + querystring.stringify(query);\n  };\n\n  self.getAuthUrl = function(state) {\n    switch(self._userConfig.oauth.type) {\n      case TOKEN.EXPLICIT:\n        return self.getExplicitAuthUrl(state);\n      case TOKEN.IMPLICIT:\n        return self.getImplicitAuthUrl(state);\n      default:\n        throw new Error(\n          'The oauth type of ' + oauthType + ' does not require an url');\n    }\n  };\n\n  /*\n     Returns the data needed to request an Applicaton Only\n     OAuth access token.\n   */\n  self.getAppOnlyTokenData = function() {\n    var params = {};\n\n    params.scope = self.scope;\n\n    // From the reddit documentation:\n    //\n    // - - -\n    // \"client_credentials\"\n    //\n    // Confidential clients (web apps / scripts) not acting on\n    // behalf of one or more logged out users.\n    //\n    // - - -\n    // \"https://oauth.reddit.com/grants/installed_client\"\n    //\n    // * Installed app types (as these apps are considered\n    // \"non-confidential\", have no secret, and thus, are\n    // ineligible for client_credentials grant.\n    //\n    // * Other apps acting on behalf of one or more \"logged out\" users.\n    //\n    switch(self._userConfig.oauth.type) {\n      case TOKEN.SCRIPT:\n      case TOKEN.EXPLICIT:\n        params.grant_type = 'client_credentials';\n        break;\n      case TOKEN.IMPLICIT:\n      default:\n        params.grant_type = 'https://oauth.reddit.com/grants/installed_client';\n        params.device_id = self._userConfig.oauth.deviceId;\n        break;\n    }\n\n    return params;\n  };\n\n  /*\n     Returns the data needed to request an authenticated OAuth\n     access token.\n   */\n  self.getAuthenticatedTokenData = function(authorizationCode) {\n    var params = {};\n\n    params.scope = self.scope;\n\n    switch (self._userConfig.oauth.type) {\n      case TOKEN.SCRIPT:\n        params.grant_type = 'password';\n        params.username = self._userConfig.oauth.username;\n        params.password = self._userConfig.oauth.password;\n        break;\n      case TOKEN.EXPLICIT:\n        params.grant_type = 'authorization_code';\n        params.client_id = self._userConfig.oauth.key;\n        params.redirect_uri = self._userConfig.oauth.redirectUri;\n        params.code = authorizationCode;\n        break;\n      default:\n        return when.reject(new Error(\n          'Invalid OAuth type specified (Authenticated OAuth).'));\n    }\n\n    return params;\n  };\n\n\n  /*\n     Returns the data needed to request a refresh token.\n   */\n  self.getRefreshTokenData = function(refreshToken) {\n    var params = {};\n    params.scope = self.scope;\n    params.grant_type = 'refresh_token';\n    params.refresh_token = refreshToken;\n    return params;\n  };\n\n  /*\n     A function that sets up a call to receive an access/refresh token.\n   */\n  self.getToken = function(tokenEnum, options) {\n\n    options = options || {};\n    var params;\n\n    switch(tokenEnum) {\n      case TOKEN.REFRESH:\n        params = self.getRefreshTokenData(options.refreshToken);\n        break;\n      case TOKEN.APP_ONLY:\n        params = self.getAppOnlyTokenData();\n        break;\n      case TOKEN.SCRIPT:\n      case TOKEN.EXPLICIT:\n        params = self.getAuthenticatedTokenData(options.authorizationCode);\n        break;\n    }\n\n    var headers = {};\n    var buff = new Buffer(self._userConfig.oauth.key + ':' +\n                          self._userConfig.oauth.secret);\n    var auth = 'Basic ' + (buff).toString('base64');\n\n    headers['Authorization'] = auth;\n\n    return self._request.https({\n      method: 'POST',\n      hostname: self._userConfig.serverWWW,\n      path: '/api/v1/access_token',\n      headers: headers\n    }, querystring.stringify(params)).then(function(response) {\n      var data;\n\n      try {\n        data = JSON.parse(response._body);\n      } catch(e) {\n        throw new Error(\n          'Failed to get Auth Data:\\n' + response._body + '\\n' + e.stack);\n      }\n\n      if (data.error) {\n        throw new Error('Error fetching a new token.\\n' + JSON.stringify(data));\n      }\n\n      return data;\n    });\n\n  };\n\n  /*\n     Sets the auth data from the oauth module to allow OAuth calls.\n\n     This function can authenticate with:\n\n     - Script based OAuth (no parameter)\n     - Raw authentication data\n     - Authorization Code (request_type = \"code\")\n     - Access Token (request_type = \"token\") / Implicit OAuth\n     - Application Only. (void 0, true);\n   */\n  self.auth = function(authCodeOrAccessToken, isApplicationOnly) {\n    var tokenData;\n\n    if (isApplicationOnly) {\n      tokenData = self.getToken(TOKEN.APP_ONLY);\n    } else {\n\n      var token = self._userConfig.oauth.type;\n\n      switch(token) {\n        case TOKEN.SCRIPT:\n          tokenData = self.getToken(token);\n          break;\n\n        case TOKEN.EXPLICIT:\n          // auth code in this case\n          tokenData = self.getToken(token, {\n            authorizationCode: authCodeOrAccessToken\n          });\n          break;\n\n        case TOKEN.IMPLICIT:\n          // access token in this case\n          tokenData = {\n            access_token: authCodeOrAccessToken,\n            token_type: 'bearer',\n            expires_in: 3600,\n            scope: self._userConfig.oauth.scope\n          };\n          break;\n\n        default:\n          throw new Error('Setting the auth data is no longer supported.');\n      }\n    }\n\n    return when(tokenData).then(function(data) {\n\n      if (typeof data !== 'object') {\n        return when.reject(new Error(\n          'There was a problem authenticating: \\n', data));\n      }\n\n      self.accessToken = data.access_token;\n      self.tokenType = data.token_type;\n\n      // If the explicit app used a perminant duration, send\n      // back the refresh token that will be used to re-authenticate\n      // later without user interaction.\n      if (data.refresh_token) {\n        // set the internal refresh token for automatic expiring\n        // access_token management\n        self.refreshToken = data.refresh_token;\n        return self.refreshToken;\n      }\n    });\n  };\n\n  /*\n     Only authenticates with Application Only OAuth\n   */\n  self.applicationOnlyAuth = function() {\n    return self.auth(void 0, true);\n  };\n\n  /*\n     Authenticate with a refresh token.\n   */\n  self.refresh = function(refreshToken) {\n\n    // use the provided refresh token, or the current\n    // one that we have for this class\n    refreshToken = refreshToken || self.refreshToken;\n\n    return self.getToken(TOKEN.REFRESH, {\n      refreshToken: refreshToken\n    }).then(function(data) {\n      // only set the internal refresh token if reddit\n      // agrees that it was OK and sends back authData\n      self.refreshToken = refreshToken;\n\n      self.accessToken = data.access_token;\n      self.tokenType = data.token_type;\n    });\n  };\n\n  /*\n     Clears any authentication data & removes OAuth authentication\n\n     By default it will only remove the \"access_token\". Specify\n     the users refresh token to revoke that token instead.\n   */\n  self.deauth = function(refreshToken) {\n\n    // no need to deauth if not authenticated\n    if (!self.isAuthenticated()) {\n      return when.resolve();\n    }\n\n    var isRefreshToken = typeof refreshToken === 'string';\n\n    var token = isRefreshToken ? refreshToken : self.accessToken;\n\n    var tokenTypeHint = isRefreshToken ? 'refresh_token' : 'access_token';\n\n    var params = {\n      token: token,\n      token_type_hint: tokenTypeHint\n    };\n\n    var auth = 'Basic ' + (new Buffer(\n      self._userConfig.oauth.key + ':' +\n      self._userConfig.oauth.secret)).toString('base64');\n\n    return self._request.https({\n      method: 'POST',\n      hostname: self._userConfig.serverWWW,\n      path: '/api/v1/revoke_token',\n      headers: { 'Authorization': auth }\n    }, querystring.stringify(params)).then(function(response) {\n      if (response._status !== 204) {\n        throw new Error('Unable to revoke the given token');\n      }\n    }).then(function() {\n      // clear the data for this OAuth object\n      self.accessToken = INVALID_TOKEN;\n      self.tokenType = INVALID_TOKEN;\n\n      if (isRefreshToken) {\n        self.refreshToken = INVALID_TOKEN;\n      }\n    });\n  };\n\n\n  return self;\n}\n","\n// node modules\nimport util from 'util';\nimport events from 'events';\nimport urlLib from 'url';\n\n// npm modules\nimport when from 'when';\nimport delay from 'when/delay';\nimport he from 'he';\n\n// our modules\nimport Request from './Request';\nimport Endpoint from './Endpoint';\n\n/*\n   A collection of functions that deal with requesting data from the\n   reddit API.\n */\nmodule.exports = RedditRequest;\nutil.inherits(RedditRequest, events.EventEmitter);\nfunction RedditRequest(userConfig, request, oauth, oauthAppOnly) {\n  var self = this;\n\n  events.EventEmitter.call(self);\n\n  self._request = request;\n  self._userConfig = userConfig;\n  self._oauth = oauth;\n  self._oauthAppOnly = oauthAppOnly;\n\n  /*\n     Currently application only?\n   */\n  function isApplicationOnly() {\n    return !self._oauth.isAuthenticated();\n  }\n\n  /*\n     Builds up the headers for an endpoint.\n   */\n  self.buildHeaders = function(endpoint) {\n    var headers = {};\n\n    if (self._userConfig.isNode) {\n      // Can't set User-Agent in browser\n      headers['User-Agent'] = self._userConfig.userAgent;\n    }\n\n    if (endpoint.contextOptions.bypassAuth || isApplicationOnly()) {\n      headers['Authorization'] = self._oauthAppOnly.getAuthorizationHeader();\n    } else {\n      headers['Authorization'] = self._oauth.getAuthorizationHeader();\n    }\n\n    return headers;\n  }\n\n  /*\n     Call the reddit api.\n   */\n  self.callRedditApi = function(endpoint) {\n\n    var parsedUrl = urlLib.parse(endpoint.url);\n\n    var reqOptions = {\n      method: endpoint.method.toUpperCase(),\n      hostname: parsedUrl.hostname,\n      path: parsedUrl.path,\n      headers: self.buildHeaders(endpoint)\n    };\n\n    if (parsedUrl.port) {\n      reqOptions.port = parsedUrl.port;\n    }\n\n    return self._request.https(reqOptions, endpoint.args).then(function(res) {\n      return self.handleRedditResponse(res, endpoint);\n    });\n  };\n\n  /*\n     Returns a uniform error for all response errors.\n   */\n  self.getResponseError = function(message, response, endpoint) {\n\n    var responseError = new Error([\n      message,\n      '>>> Response Status: ' + response._status,\n      '>>> Endpoint URL: '+ endpoint.url,\n      '>>> Arguments: ' + JSON.stringify(endpoint.args, null, 2),\n      '>>> Response Body:',\n      response._body\n    ].join('\\n\\n'));\n\n    responseError.url = endpoint.url;\n    responseError.args = endpoint.args;\n    responseError.status = response._status;\n    responseError.body = response._body;\n    responseError.endpoint = endpoint;\n\n    return responseError;\n  };\n\n  /*\n     Handle a reddit 500 / server error. This will try to call the endpoint again\n     after the given retryDelay. If we do not have any retry attempts left, it\n     will reject the promise with the error.\n   */\n  self.handleServerErrorResponse = function(response, endpoint) {\n\n    endpoint.contextOptions.retryAttemptsLeft--;\n\n    var responseError = self.getResponseError('Server Error Response',\n                                              response,\n                                              endpoint);\n\n    responseError.retryAttemptsLeft = endpoint.contextOptions.retryAttemptsLeft;\n\n    self.emit('server_error', responseError);\n\n    if (endpoint.contextOptions.retryAttemptsLeft <= 0) {\n      responseError.message = ('All retry attempts exhausted.\\n\\n' +\n                               responseError.message);\n      return when.reject(responseError);\n    }\n\n    return delay(endpoint.contextOptions.retryDelay).then(function() {\n      return self.callRedditApi(endpoint);\n    });\n  };\n\n  /*\n     Handle a reddit 4xx / client error. This is usually caused when our\n     access_token has expired.\n\n     If we can't renew our access token, we throw an error / emit the\n     'access_token_expired' event that users can then handle to\n     re-authenticatet clients\n\n     If we can renew our access token, we try to reauthenticate, and call the\n     reddit endpoint again.\n   */\n  self.handleClientErrorResponse = function(response, endpoint) {\n\n    // - - -\n    // Check headers for more specific errors.\n\n    var wwwAuth = response._headers['www-authenticate'];\n\n    if (wwwAuth && wwwAuth.indexOf('insufficient_scope') !== -1) {\n      return when.reject(self.getResponseError(\n        'Insufficient scopes provided for this call',\n        response,\n        endpoint));\n    }\n\n    // - - -\n    // Parse the response for more specific errors.\n\n    try {\n      var data = JSON.parse(response._body);\n\n      if (data.reason === 'USER_REQUIRED') {\n        var msg = 'Must be authenticated with a user to make this call';\n        return when.reject(self.getResponseError(msg, response, endpoint));\n      }\n\n    } catch(e) {}\n\n    // - - -\n    // Access token has expired\n\n    if (response._status === 401) {\n\n      self.emit('access_token_expired');\n\n      var canRenewAccessToken = (isApplicationOnly() ||\n                                 self._oauth.hasRefreshToken() ||\n                                 self._userConfig.isOAuthType('script'));\n\n      if (!canRenewAccessToken) {\n        var errmsg = 'Access token has expired. Listen for ' +\n                     'the \"access_token_expired\" event to ' +\n                     'handle this gracefully in your app.';\n        return when.reject(self.getResponseError(errmsg, response, endpoint));\n      } else {\n\n        // Renew our access token\n\n        --endpoint.contextOptions.reauthAttemptsLeft;\n\n        if (endpoint.contextOptions.reauthAttemptsLeft <= 0) {\n          return when.reject(self.getResponseError(\n            'Unable to refresh the access_token.',\n            response,\n            endpoint));\n        }\n\n        var reauth;\n\n        // If we are application only, or are bypassing authentication\n        // therefore we're using application only OAuth\n        if (isApplicationOnly() || endpoint.contextOptions.bypassAuth) {\n          reauth = self._oauthAppOnly.applicationOnlyAuth();\n        } else {\n\n          // If we have been authenticated with a permanent refresh token use it\n          if (self._oauth.hasRefreshToken()) {\n            reauth = self._oauth.refresh();\n          }\n\n          // If we are OAuth type script we can call `.auth` again\n          if (self._userConfig.isOAuthType('script')) {\n            reauth = self._oauth.auth();\n          }\n\n        }\n\n        return reauth.then(function() {\n          return self.callRedditApi(endpoint);\n        });\n\n      }\n    }\n\n    // - - -\n    // At the end of the day, we just throw an error stating that there\n    // is nothing we can do & give general advice\n    return when.reject(self.getResponseError(\n      ('This call failed. ' +\n       'Is the user missing reddit gold? ' +\n       'Trying to change a subreddit that the user does not moderate? ' +\n       'This is an unrecoverable error.'),\n      response,\n      endpoint));\n  };\n\n  /*\n     Handle reddit response status of 2xx.\n\n     Finally return the data if there were no problems.\n   */\n  self.handleSuccessResponse = function(response, endpoint) {\n    var data = response._body || '';\n\n    if (endpoint.contextOptions.decodeHtmlEntities) {\n      data = he.decode(data);\n    }\n\n    // Attempt to parse some JSON, otherwise continue on (may be empty, or text)\n    try {\n      data = JSON.parse(data);\n    } catch(e) {}\n\n    return when.resolve(data);\n  };\n\n  /*\n     Handles various reddit response cases.\n   */\n  self.handleRedditResponse = function(response, endpoint) {\n\n    switch(String(response._status).substring(0, 1)) {\n      case '5':\n        return self.handleServerErrorResponse(response, endpoint);\n      case '4':\n        return self.handleClientErrorResponse(response, endpoint);\n      case '2':\n        return self.handleSuccessResponse(response, endpoint);\n    }\n\n    return when.reject(new Error(\n      'Invalid reddit response status of ' + response._status));\n  };\n\n  /*\n     Listing support.\n   */\n  function getListing(endpoint) {\n\n    // number of results that we have loaded so far. It will\n    // increase / decrease when calling next / previous.\n    var count = 0;\n    var limit = endpoint.args.limit || 25;\n    // keep a reference to the start of this listing\n    var start = endpoint.args.after || null;\n\n    function getSlice(endpoint) {\n\n      return self.callRedditApi(endpoint).then(function(result) {\n\n        var slice = {};\n        var listing = result || {};\n\n        slice.get = result || {};\n\n        if (result instanceof Array) {\n          if (typeof endpoint.contextOptions.listingIndex === 'undefined') {\n            throw new Error('Must specify a `listingIndex` for this listing.');\n          }\n\n          listing = result[endpoint.contextOptions.listingIndex];\n        }\n\n        slice.count = count;\n\n        slice.before = listing.data.before || null;\n        slice.after = listing.data.after || null;\n        slice.allChildren = listing.data.children || [];\n\n        slice.empty = slice.allChildren.length === 0;\n\n        slice.children = slice.allChildren.filter(function(child) {\n          return !child.data.stickied;\n        });\n\n        slice.stickied = slice.allChildren.filter(function(child) {\n          return child.data.stickied;\n        });\n\n        slice.next = function() {\n          count += limit;\n\n          var newArgs = endpoint.args;\n          newArgs.before = null;\n          newArgs.after = slice.children[slice.children.length - 1].data.name;\n          newArgs.count = count;\n          return getSlice(new Endpoint(self._userConfig,\n                                       endpoint.method,\n                                       endpoint.path,\n                                       newArgs,\n                                       endpoint.contextOptions));\n        };\n\n        slice.previous = function() {\n          count -= limit;\n\n          var newArgs = endpoint.args;\n          newArgs.before = slice.children[0].data.name;\n          newArgs.after = null;\n          newArgs.count = count;\n          return getSlice(new Endpoint(self._userConfig,\n                                       endpoint.method,\n                                       endpoint.path,\n                                       newArgs,\n                                       endpoint.contextOptions));\n        };\n\n        slice.start = function() {\n          count = 0;\n\n          var newArgs = endpoint.args;\n          newArgs.before = null;\n          newArgs.after = start;\n          newArgs.count = count;\n          return getSlice(new Endpoint(self._userConfig,\n                                       endpoint.method,\n                                       endpoint.path,\n                                       newArgs,\n                                       endpoint.contextOptions));\n        };\n\n        slice.requery = function() {\n          return getSlice(endpoint);\n        };\n\n        return slice;\n      });\n\n    }\n\n    return getSlice(endpoint);\n  }\n\n  /*\n     Enable path syntax support, e.g. self.path('/path/to/$endpoint/etc')\n\n     Can take an url as well, but the first part of the url is chopped\n     off because it is not needed. We will always use the server oauth\n     to call the API...\n\n     e.g. https://www.example.com/api/v1/me\n\n     will only use the path: /api/v1/me\n   */\n  self.path = function(urlOrPath) {\n\n    var parsed = urlLib.parse(urlOrPath);\n    var path = parsed.pathname;\n\n    var calls = {};\n\n    ['get', 'post', 'put', 'patch', 'delete', 'update'].forEach(function(verb) {\n      calls[verb] = function(userGivenArgs, userContextOptions) {\n        return self.callRedditApi(new Endpoint(self._userConfig,\n                                          verb,\n                                          path,\n                                          userGivenArgs,\n                                          userContextOptions));\n      };\n    });\n\n    // Add listing support\n    calls.listing = function(userGivenArgs, userContextOptions) {\n      return getListing(new Endpoint(self._userConfig,\n                                     'get',\n                                     path,\n                                     userGivenArgs,\n                                     userContextOptions));\n    };\n\n    return calls;\n  };\n\n\n\n  return self;\n}\n","\nimport utils from './utils';\n\n// Browserify switches it to httpsBrowser for us when building\n// for browsers.\n//\n// This is defined in `package.json`\nimport https from './https/httpsNode';\n\nmodule.exports = Request;\nfunction Request(throttle) {\n  var self = this;\n\n  self._throttle = throttle;\n\n  self.https = function(options, formData) {\n    return self._throttle.wait().then(function() {\n      return httpsRequest.https(options, formData);\n    });\n  };\n  \n  return self;\n}\n","\"use strict\";\n\n// Node.js libraries\nimport events from 'events';\nimport util from 'util';\n\n// Our modules\nimport Request from './Request';\nimport RedditRequest from './RedditRequest';\nimport Throttle from './Throttle';\nimport UserConfig from './UserConfig';\nimport OAuth from './OAuth';\n\nSnoocore.file = require('./https/file');\nSnoocore.version = '3.0.0';\n\nmodule.exports = Snoocore;\nutil.inherits(Snoocore, events.EventEmitter);\nfunction Snoocore(userConfiguration) {\n\n  var self = this;\n\n  events.EventEmitter.call(self);\n\n  // @TODO - this is a \"god object\" of sorts.\n  self._userConfig = new UserConfig(userConfiguration);\n\n  self._throttle = new Throttle(self._userConfig.throttle);\n\n  self._request = new Request(self._throttle);\n\n  // Two OAuth instances. One for authenticated users, and another for\n  // Application only OAuth. Two are needed in the instance where\n  // a user wants to bypass authentication for a call - we don't want\n  // to waste time by creating a new app only instance, authenticating,\n  // etc.\n  self.oauth = new OAuth(self._userConfig, self._request);\n  self.oauthAppOnly = new OAuth(self._userConfig, self._request);\n\n  // Expose OAuth functions in here\n  self.getExplicitAuthUrl = self.oauth.getExplicitAuthUrl;\n  self.getImplicitAuthUrl = self.oauth.getImplicitAuthUrl;\n  self.auth = self.oauth.auth;\n  self.refresh = self.oauth.refresh;\n  self.deauth = self.oauth.deauth;\n\n  self._redditRequest = new RedditRequest(self._userConfig,\n                                          self._request,\n                                          self.oauth,\n                                          self.oauthAppOnly);\n\n  // bubble up the events\n  self._redditRequest.on('server_error', function(responseError) {\n    self.emit('server_error', responseError);\n  });\n\n  self._redditRequest.on('access_token_expired', function(responseError) {\n    self.emit('access_token_expired', responseError);\n  });\n\n  /*\n     Make self._redditRequest.path the primary function that we return, but\n     still allow access to the objects defined on self\n   */\n  var key;\n  for (key in self) {\n    self._redditRequest.path[key] = self[key];\n  }\n\n  self = self._redditRequest.path;\n  return self;\n}\n","/*\n   A basic throttle manager. Exposes 1 functoin `wait` that\n   will return a promise that resolves once we've waited the proper\n   amount of time, e.g.\n\n   var throttle = new Throttle();\n\n   throttle.wait() // resolves after 1ms\n   throttle.wait() // resolves after 10001ms\n   throttle.wait() // resolves after 2001ms\n\n */\n\nimport when from 'when';\nimport delay from 'when/delay';\n\nmodule.exports = Throttle;\nfunction Throttle(throttleMs) {\n\n  var self = this;\n\n  // default to 1000ms delay\n  self._throttleMs = throttleMs || 1000;\n\n  /*\n     The current throttle delay before a request will go through\n     increments every time a call is made, and is reduced when a\n     call finishes.\n\n     Time is added & removed based on the throttle variable.\n   */\n  self._throttleDelay = 1;\n\n  self.wait = function() {\n    // resolve this promise after the current throttleDelay\n    var delayPromise = delay(self._throttleDelay);\n\n    // add throttleMs to the total throttleDelay\n    self._throttleDelay += self._throttleMs;\n\n    // after throttleMs time, subtract throttleMs from\n    // the throttleDelay\n    setTimeout(function() {\n      self._throttleDelay -= self._throttleMs;\n    }, self._throttleMs);\n\n    return delayPromise;\n  };\n\n  return self;\n}\n","import utils from './utils';\n\n/*\n   A class made up of the user configuration.\n\n   Normalizes the configuraiton & checks for simple errors.\n\n   Provides some helper functons for getting user set values.\n */\nmodule.exports = UserConfig;\nfunction UserConfig(userConfiguration) {\n\n  var self = this;\n\n\n  //\n  // - - - CONFIGURATION VALUES - - -\n  //\n\n  var missingMsg = 'Missing required userConfiguration value ';\n\n  // ** SERVERS\n  self.serverOAuth = utils.thisOrThat(userConfiguration.serverOAuth,\n                                      'oauth.reddit.com');\n\n  self.serverWWW = utils.thisOrThat(userConfiguration.serverWWW,\n                                    'www.reddit.com');\n\n\n  // ** IDENFIFICATION\n  self.userAgent = utils.thisOrThrow(\n    userConfiguration.userAgent,\n    'Missing required userConfiguration value `userAgent`');\n\n  self.isNode = utils.thisOrThat(userConfiguration.browser, utils.isNode());\n\n  self.mobile = utils.thisOrThat(userConfiguration.mobile, false);\n\n  // ** CALL MODIFICATIONS\n  self.decodeHtmlEntities = utils.thisOrThat(\n    userConfiguration.decodeHtmlEntities,\n    false);\n\n  self.apiType = utils.thisOrThat(userConfiguration.apiType, 'json');\n\n\n\n  // ** RETRY ATTEMPTS\n  self.retryAttempts = utils.thisOrThat(userConfiguration.retryAttempts, 60);\n\n  self.retryDelay = utils.thisOrThat(userConfiguration.retryDelay, 5000);\n\n\n  // ** OAUTH\n  self.oauth = utils.thisOrThat(userConfiguration.oauth, {});\n\n  self.oauth.scope = utils.thisOrThat(self.oauth.scope, []);\n\n  self.oauth.deviceId = utils.thisOrThat(self.oauth.deviceId,\n                                         'DO_NOT_TRACK_THIS_DEVICE');\n  self.oauth.type = utils.thisOrThrow(self.oauth.type,\n                                      missingMsg + '`oauth.type`');\n  self.oauth.key = utils.thisOrThrow(self.oauth.key,\n                                     missingMsg + '`oauth.key`');\n\n\n  //\n  // - - - FUNCTIONS - - -\n  //\n\n  /*\n     Checks if the oauth is of a specific type, e.g.\n\n     isOAuthType('script')\n   */\n  self.isOAuthType = function(type) {\n    return self.oauth.type === type;\n  }\n\n\n  //\n  // - - - VALIDATION\n  //\n\n  if (!self.isOAuthType('explicit') &&\n    !self.isOAuthType('implicit') &&\n    !self.isOAuthType('script'))\n  {\n    throw new Error(\n      'Invalid `oauth.type`. Must be one of: explicit, implicit, or script');\n  }\n\n  if (self.isOAuthType('explicit') || self.isOAuthType('script')) {\n    self.oauth.secret = utils.thisOrThrow(\n      self.oauth.secret,\n      missingMsg + '`oauth.secret` for type explicit/script');\n  }\n\n\n  if (self.isOAuthType('script')) {\n    self.oauth.username = utils.thisOrThrow(\n      self.oauth.username,\n      missingMsg + '`oauth.username` for type script');\n    self.oauth.password = utils.thisOrThrow(\n      self.oauth.password,\n      missingMsg + '`oauth.password` for type script');\n  }\n\n  if (self.isOAuthType('implicit') || self.isOAuthType('explicit')) {\n    self.oauth.redirectUri = utils.thisOrThrow(\n      self.oauth.redirectUri,\n      missingMsg + '`oauth.redirectUri` for type implicit/explicit');\n  }\n\n  return self;\n}\n","\"use strict\";\n\n// checks basic globals to help determine which environment we are in\nexports.isNode = function() {\n  return typeof require === \"function\" &&\n  typeof exports === \"object\" &&\n  typeof module === \"object\" &&\n  typeof window === \"undefined\";\n};\n\n/*\n   Return the value of `tryThis` unless it's undefined, then return `that`\n */\nexports.thisOrThat = function(tryThis, that) {\n  return (typeof tryThis !== 'undefined') ? tryThis : that;\n};\n\n/*\n   Return the value of `tryThir` or throw an error (with provided message);\n */\nexports.thisOrThrow = function(tryThis, orThrowMessage) {\n  if (typeof tryThis !== 'undefined') { return tryThis; }\n  throw new Error(orThrowMessage);\n};\n","/*\nRepresents a file that we wish to upload to reddit.\n\nAll files have a name, mimeType, and data. \n\ndata can be a `utf8` string, or a buffer containing the \ncontent of the file.\n*/\n\nmodule.exports = function(name, mimeType, data) {\n  var self = {};\n\n  self.name = name;\n  self.mimeType = mimeType;\n  self.data = (typeof data === 'string') ? new Buffer(data) : data;\n\n  return self;\n};\n","\nimport querystring from 'querystring';\n\nimport when from 'when';\n\nexports.getSectionBoundary = function(boundary) {\n  return '--' + boundary;\n};\n\nexports.getEndBoundary = function(boundary) {\n  return '--' + boundary + '--';\n};\n\nexports.encodeFieldPart = function(boundary, key, value) {\n  return new Buffer([\n    exports.getSectionBoundary(boundary),\n    '\\r\\n',\n    'Content-Disposition: form-data; name=\"' + key + '\"',\n    '\\r\\n\\r\\n',\n    value,\n    '\\r\\n'\n  ].join(''));\n};\n\nexports.encodeFilePart = function(boundary, key, name, mimeType, data) {\n  return Buffer.concat([\n    new Buffer([\n      exports.getSectionBoundary(boundary),\n      '\\r\\n',\n      ('Content-Disposition: form-data; ' +\n       'name=\"' + key + '\"; ' +\n       'filename=\"' + name + '\"'),\n      '\\r\\n',\n      'Content-Type: ' + mimeType,\n      '\\r\\n\\r\\n'\n    ].join('')),\n    data, // already a buffer\n    new Buffer('\\r\\n')\n  ]);\n};\n\n/*\n   Converts a list of parameters to form data\n\n   - `fields` - a property map of key value pairs\n   - `files` - a list of property maps of content\n   --> `type` - the type of file data\n   --> `keyname` - the name of the key corresponding to the file\n   --> `valuename` - the name of the value corresponding to the file\n   --> `dataBuffer` - A buffer containing the files data\n */\nexports.getMultipartFormData = function(boundary, fields, files) {\n\n  var dataBuffer = new Buffer(0);\n  var key;\n\n  if (fields) {\n    for (key in fields) {\n      // skip over any file fields\n      if (key === 'file') { continue; }\n\n      var value = fields[key];\n\n      dataBuffer = Buffer.concat([\n\tdataBuffer, exports.encodeFieldPart(boundary, key, value)\n      ]);\n    }\n  }\n\n  if (files) {\n    for (key in files) {\n      var file = files[key];\n\n      dataBuffer = Buffer.concat([\n\tdataBuffer,\n\texports.encodeFilePart(boundary,\n\t\t\t       file.key,\n\t\t\t       file.name,\n\t\t\t       file.mimeType,\n\t\t\t       file.data)\n      ]);\n    }\n  }\n\n  // close with a final boundary closed with '--' at the end\n  dataBuffer = Buffer.concat([\n    dataBuffer,\n    new Buffer(exports.getEndBoundary(boundary))\n  ]);\n\n  return dataBuffer;\n};\n\n/*\n   Takes an existing string or key-value pair that represents form data\n   and returns form data in the form of an Array.\n\n   If the formData is an object, and that object has a 'file' key,\n   we will assume that it is going to be a multipart request and we\n   will also assume that the file is actually a file path on the system\n   that we wish to use in the multipart data.\n */\nexports.getData = function(formData) {\n\n  var data = {\n    contentType: 'application/x-www-form-urlencoded',\n    contentLength: 0,\n    buffer: new Buffer(0)\n  };\n\n  // The data is already in a string format. There is nothing\n  // to do really\n  if (typeof formData === 'string') {\n    data.buffer = new Buffer(formData);\n  }\n\n  if (typeof formData === 'object') {\n    // The data is an object *without* a file key. We will assume\n    // that we want this data in an url encoded format\n    if (!formData.file) {\n      data.buffer = new Buffer(querystring.stringify(formData));\n    } else {\n      // for now we only have to handle one file, with one key name of 'file'\n      var singleFile = formData.file;\n      singleFile.key = 'file';\n\n      var files = [ formData.file ];\n\n      var boundary = '---------Snoocore' + Math.floor(Math.random() * 10000);\n      data.contentType = 'multipart/form-data; boundary=' + boundary;\n      data.buffer = exports.getMultipartFormData(boundary, formData, files);\n    }\n  }\n\n  data.contentLength = data.buffer.length;\n  return data;\n};\n","//\n// Browser requests, mirrors the syntax of the node requests\n//\n\nimport when from 'when';\n\nimport form from './form';\n\n// https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest#getAllResponseHeaders()\n\nexport default function(options, formData) {\n\n  options = options || {};\n  options.headers = options.headers || {};\n\n  var data = form.getData(formData);\n\n  options.headers['Content-Type'] = data.contentType;\n\n  return when.promise(function(resolve, reject) {\n\n    try {\n      // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\n      var x = new window.XMLHttpRequest();\n\n      var url = 'https://' + options.hostname + options.path;\n\n      // append the form data to the end of the url\n      if (options.method === 'GET') {\n        url += '?' + data.buffer.toString();\n      }\n\n      x.open(options.method, url, true);\n\n      Object.keys(options.headers).forEach(function(headerKey) {\n        x.setRequestHeader(headerKey, options.headers[headerKey]);\n      });\n\n      x.onreadystatechange = function() {\n        if (x.readyState > 3) {\n          // Normalize the result to match how requestNode.js works\n\n          console.log(x.getAllResponseHeaders());\n\n          return resolve({\n            _body: x.responseText,\n            _status: x.status,\n            _headers: x.getAllResponseHeaders()\n          });\n        }\n      };\n\n      x.send(options.method === 'GET' ? null : data.buffer.toString());\n\n    } catch (e) {\n      return reject(e);\n    }\n\n  });\n}\n","//\n// Node requests\n//\n\nimport https from 'https';\n\nimport when from 'when';\n\nimport form from './form';\n\n/*\n   Form data can be a raw string, or an object containing key/value pairs\n */\nexport default function(options, formData) {\n  // console.log('\\n\\n\\n\\n');\n  // console.log('>>> request');\n  // console.log(options.method + ': ' + options.hostname + options.path);\n\n  options = options || {};\n  options.headers = options.headers || {};\n\n  formData = formData || [];\n\n  var data = form.getData(formData);\n\n  options.headers['Content-Type'] = data.contentType;\n\n  if (options.method !== 'GET') {\n    options.headers['Content-Length'] = data.contentLength;\n  }\n\n  // console.log('\\n>>> headers\\n', options.headers);\n\n  // stick the data at the end of the url for GET requests\n  if (options.method === 'GET' && data.buffer.toString() !== '') {\n    options.path += '?' + data.buffer.toString();\n  }\n\n  return when.promise(function(resolve, reject) {\n\n    var req = https.request(options, function(res) {\n\n      res._req = req; // attach a reference back to the request\n\n      res.setEncoding('utf8');\n      var body = '';\n      res.on('error', function(error) { return reject(error); });\n      res.on('data', function(chunk) { body += chunk; });\n      res.on('end', function() {\n        res._body = body; // attach the response body to the object\n        res._status = res.statusCode;\n        res._headers = res.headers;\n\n        // console.log('\\n>>> body\\n', body);\n        // console.log('\\n>>> status\\n', res.statusCode);\n        return resolve(res);\n      });\n    });\n\n    if (options.method !== 'GET') {\n      req.write(data.buffer);\n    }\n\n    req.end();\n\n  }).then(function(res) {\n    // @TODO no endpoints except /logout require redirects, but if it's\n    // needed in the future we can handle it here\n    return res;\n  });\n\n}\n"],"sourceRoot":"/source/"}